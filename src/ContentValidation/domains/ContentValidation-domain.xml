<?xml version="1.0" encoding="UTF-8"?>
<domain xmlns="http://www.xquerrail-framework.com/domain">
    <name>ContentValidation</name>
    <content-namespace prefix="cvf">http://marklogic.com/ps/content-validation</content-namespace>
    <application-namespace>http://marklogic.com/ps/content-validation</application-namespace>
    <description>Content Validation Framework</description>
    <author>Gary Vidal</author>
    <version>1.0</version>
    <model name="project" description="A project in a content validation framework">        
        <required-namespace prefix="dc" namespace-uri="http://purl.org/dc/elements/1.1"/>
        <required-namespace prefix="dcterms" namespace-uri="http://purl.org/dc/terms/"/>
<!--        <import-model name="vendor"/>
        <import-model name="user"/>
        <import-model name="schema"/>
        <import-model name="schematron"/>
-->
        <element name="identifier" identity="true" description="Default ID Value for document" type="xs:ID">
            <navigation  searchable="value" facetable="false" sortable="true"/>
            <constraint  required="true"/>
        </element>
        <element name="name" type="xs:string">
            <navigation searchable="value" sortable="true"/>
            <constraint minLength="1" maxLength="9" required="true"/>
        </element>
        <element name="isbn" type="xs:string">
            <navigation searchable="value" sortable="true" />
            <constraint required="true" minLength="9" maxLength="9" />
        </element>
        <element name="edition" type="xs:string">
            <navigation searchable="value" sortable="true"/>
        </element>
        <element name="author" type="xs:string">
            <navigation  searchable="value" sortable="true"/>
        </element>
        <element name="vendor-ref" type="element()" ref="vendor:reference">
            <navigation facetable="true" sortable="true"/>
        </element>
        <element name="schema-ref" type="element()" ref="schema:reference">
            <navigation facetable="true" sortable="true"/>
        </element>
        <element name="status" type="xs:string" required="true" default="Created">
            <constraint inList="project-status" match=""/>
            <navigation searchable="range" facetable="true" sortable="true"/>
        </element>
        <sequence name="notify">
            <reference name="user-ref" type="xs:string" model="user:reference"/>
        </sequence>
        <sequence name="schematrons">
            <reference name="schematron-ref" type="reference:schematron" model="model:schematron:reference">
                <constraint required="true"/>
            </reference>
        </sequence>
        <children>
            <child model="job" delete="cascade" update="cascade"/>
        </children>
        <optionlist name="project-status" child-element="status" type="xs:string">
            <option>Created</option>
            <option>Closed</option>
            <option>Pending</option>
        </optionlist>
    </model>
    <controller name="project" model="project">
        <!--Rest Actions-->
        <action name="list" handles="list" default-template="list" />
        <action name="update" handles="update" />
        <action name="delete" handles="delete" />
        <action name="add" handles="create"/>
        <action name="collection" handles="collection"/>
        <action name="get" handles="get"/>
        <action name="info" handles="info"/>
        <action name="search" handles="search"/>
        <action name="validate" handles="validate"/>          
        <!--Web Actions-->
        <action name="index"/>
        <action name="find" uses="search"/>
        <action name="show" uses="get"/>
        <action name="edit" uses="get" />
        <action name="remove" uses="delete"/>
        <action name="new" uses="create"/>
    </controller>
</domain>
