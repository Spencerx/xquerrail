<?xml version="1.0" encoding="UTF-8"?>
<domain xmlns="http://www.xquerrail-framework.com/domain">
    <name>ContentValidation</name>
    <namespace>http://marklogic.com/ps/content-validation</namespace>
    <description>Content Validation Framework</description>
    <author>Gary Vidal</author>
    <version>1.0</version>
    <model name="project" description="A project in a content validation framework">        
        <required-namespace prefix="dc" uri="http://purl.org/dc/elements/1.1"/>
        <required-namespace prefix="dcterms" uri="http://purl.org/dc/terms/"/>
        <import-model name="vendor"/>
        <import-model name="user"/>
        <import-model name="schema"/>
        <import-model name="schematron"/>
        <element name="id" description="Default ID Value for document" type="xs:ID" 
            searchable="value" facetable="true" sortable="true" required="true">
            <constraint id-field="true" required="true" />
        </element>
        <element name="name" type="xs:string" searchable="value" sortable="true" required="true">
            <constraint minLength="1" maxLength="9" required="true"/>
        </element>
        <element name="isbn" type="xs:string" searchable="value" sortable="true" required="true">
            <constraint minLength="9" maxLength="9" />
        </element>
        <element name="edition" type="xs:string" searchable="value" sortable="true" />
        <element name="author" type="xs:string" searchable="value" sortable="true"/>
        <element name="vendor-ref" type="element()" ref="vendor:reference" facetable="true" sortable="true"/>
        <element name="schema-ref" type="element()" ref="schema:reference" facetable="true" sortable="true"/>
        <element name="status" type="xs:string" required="true" default="Created">
            <constraint inList="project-status"/>
        </element>
        <sequence name="notify">
            <reference name="user-ref" type="xs:string" model="user:reference"/>
        </sequence>
        <sequence name="schematrons">
            <reference name="schematron-ref" type="reference:schematron" model="model:schematron:reference" required="true"/>
        </sequence>
        <children>
            <child model="job" delete="cascade" update="cascade"/>
        </children>
        <optionlist name="project-status" child-element="status" type="xs:string">
            <status>Created</status>
            <status>Closed</status>
            <status>Pending</status>
        </optionlist>
    </model>
    <controller name="project" model="project">
        <!--Rest Actions-->
        <action name="list" handles="list" default-template="list" />
        <action name="update" handles="update"  />
        <action name="delete" handles="delete"  />
        <action name="add" handles="create"/>
        <action name="collection" handles="collection"/>
        <action name="get" handles="get"/>
        <action name="info" handles="info"/>
        <action name="search" handles="search"/>
        <action name="validate" handles="validate"/>          
        <!--Web Actions-->
        <action name="index"/>
        <action name="find"/>
        <action name="show"/>
        <action name="edit"/>
        <action name="remove"/>
        <action name="new"/>
    </controller>
</domain>
